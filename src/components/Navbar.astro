---
import { Image } from "astro:assets";
import { site } from "../data/site";
import NavMenu from "./NavMenu.astro";
import logo from "../assets/logo.png";
---

<nav class="mx-auto flex max-w-[72rem] items-center justify-between px-4 py-2">
  <!-- left cluster -->
  <div class="flex items-center">
    <a href="/" class="flex items-center text-inherit no-underline">
      <Image src={logo} alt="The FurtherSouth logo" width="50" height="50" />
      <span class="ml-2 text-xl font-bold">{site.name}</span>
    </a>
    <div class="ml-8 flex flex-col text-xs leading-tight text-slate-700">
      <span>{site.location}</span>
      <span>{site.date}</span>
    </div>
  </div>
  <!-- right cluster -->
  <div class="hidden items-center gap-4 md:flex">
    {site.nav.map((it) => <NavMenu label={it.label} folder={it.folder} />)}
  </div>
  <button
    id="mobile-menu-button"
    class="p-2 md:hidden"
    aria-expanded="false"
    aria-controls="mobile-menu"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-6 w-6"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
  </button>
</nav>
<div
  id="mobile-menu"
  class="hidden flex-col gap-2 border-t border-soft px-4 pb-4 md:hidden"
>
  {site.nav.map((it) => <NavMenu mobile label={it.label} folder={it.folder} />)}
</div>
<script is:inline>
  document
    .getElementById("mobile-menu-button")
    ?.addEventListener("click", function () {
      const expanded = this.getAttribute("aria-expanded") === "true";
      this.setAttribute("aria-expanded", String(!expanded));
      document
        .getElementById("mobile-menu")
        ?.classList.toggle("hidden", expanded);
    });
  document.querySelectorAll("button[data-nav-toggle]").forEach((btn) => {
    const listId = btn.getAttribute("aria-controls");
    const list = listId && document.getElementById(listId);
    btn.addEventListener("click", () => {
      const expanded = btn.getAttribute("aria-expanded") === "true";
      btn.setAttribute("aria-expanded", String(!expanded));
      list?.classList.toggle("hidden", expanded);
    });
  });
</script>
